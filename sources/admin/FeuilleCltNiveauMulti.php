<?phpinclude_once('../commun/MyPage.php');include_once('../commun/MyBdd.php');include_once('../commun/MyTools.php');define('FPDF_FONTPATH','font/');require('../fpdf/fpdf.php');// Gestion de la Feuille de Classementclass FeuilleCltNiveauMulti extends MyPage	 {		function FeuilleCltNiveauMulti()	{		MyPage::MyPage();	  		$myBdd = new MyBdd();				$codeSaison = utyGetSaison();		$codeCompet = utyGetGet('codeCompet', '');		$listCompet = explode(',',$codeCompet);				for ($h=0;$h<count($listCompet);$h++)		{			$arrayCompetition[$h] = $myBdd->GetCompetition($listCompet[$h], $codeSaison);			$titreCompet[$h] = 'Compétition : '.$arrayCompetition[$h]['Libelle'].' ('.$listCompet[$h].')';			$qualif[$h] = $arrayCompetition[$h]['Qualifies'];			$elim[$h] = $arrayCompetition[$h]['Elimines'];			$typeClt[$h] = $arrayCompetition[$h]['Code_typeclt'];		}				//Saison		$titreDate = "Saison ".$codeSaison;		//Création		$pdf = new FPDF('L');		$pdf->Open();		$pdf->SetTitle("Classement");				$pdf->SetAuthor("Poloweb.org");		$pdf->SetCreator("Poloweb.org avec FPDF");		$pdf->AddPage();		$pdf->SetAutoPageBreak(true, 15);				// logo		$pdf->Image($_SERVER['DOCUMENT_ROOT'].'/css/banniere1.jpg',10,8,72,15,'jpg',"https://www.kayak-polo.info");		$pdf->Image($_SERVER['DOCUMENT_ROOT'].'/css/logo_ffck4.png',255,8,24,15,'png',"https://www.ffck.org");		$pdf->Ln(14);		// titre		$pdf->SetFont('Arial','BI',10);		$pdf->Cell(137,5,"Compétition à élimination",'LT','0','L');		$pdf->Cell(136,5,$titreDate,'TR','1','R');		$pdf->SetFont('Arial','B',14);//		$pdf->Cell(273,5,$titreCompet,'LR','1','C');		$pdf->Cell(273,5,"Classement général",'LRB','1','C');		$pdf->SetFont('Arial','BI',9);		$pdf->Cell(137,5,"Edité le ".date("d/m/Y")." à ".date("H:i"),'0','0','L');		$pdf->Cell(136,5,"Classement provisoire",'0','1','R');		$pdf->Ln(4);		for ($h=0;$h<count($listCompet);$h++)		{			//données			$sql  = "Select Id, Libelle, Code_club, Clt, Pts, J, G, N, P, F, Plus, Moins, Diff, PtsNiveau, CltNiveau ";			$sql .= "From gickp_Competitions_Equipes ";			$sql .= "Where Code_compet = '";			$sql .= $listCompet[$h];			$sql .= "' And Code_saison = '";			$sql .= $codeSaison;			if ($typeClt[$h] == 'CHPT')				$sql .= "' Order By Clt Asc, Diff Desc ";			else				$sql .= "' Order By CltNiveau Asc, Diff Desc ";								$result = mysql_query($sql, $myBdd->m_link) or die ("Erreur Load");			$num_results = mysql_num_rows($result);						// recalcul des éliminés			$elim[$h] = $num_results - $elim[$h];			$pdf->SetFont('Arial','BI',9);			$pdf->Cell(72,6, '','','0','L');//			$pdf->Cell(30, 6, 'Classement', 'LTR','0','C');//			$pdf->Cell(100,6, 'Equipe','RT','1','C');			$pdf->Cell(130, 6, 'Classement '.$titreCompet[$h], 'LTR','1','C');			$pdf->Cell(72,3, '','','0');			$pdf->Cell(130, 3, '', 'TB','1','C');						for ($i=0;$i<$num_results;$i++)			{				$row = mysql_fetch_array($result);					$separation = 0;				//Séparation qualifiés				if (($i+1) > $qualif[$h] && $qualif[$h] != 0)				{					$pdf->Cell(72,1, '', 0,0);					$pdf->Cell(130,1, '', 0,1);					$qualif[$h] =0;					$separation = 1;				}				//Séparation éliminés				if (($i+1) > $elim[$h] && $elim[$h] != 0)				{					if ($separation != 1)					{						$pdf->Cell(72,1, '', 0,0);						$pdf->Cell(130,1, '', 0,1);					}					$elim[$h] =0;				}								$pdf->SetFont('Arial','B',12);				$pdf->Cell(72,6, '','','0','L');				if ($typeClt[$h] == 'CHPT')					$pdf->Cell(30, 5, $row['Clt'], 'LTBR','0','C');				else					$pdf->Cell(30, 5, $row['CltNiveau'], 'LTBR','0','C');								$pdf->Cell(100,5, $row['Libelle'],'RTB','1','L');			}			$pdf->Cell(130,10, '', 0,1);		}					$pdf->Output('Classement '.$codeCompet.'.pdf','I');	}}$page = new FeuilleCltNiveauMulti();