<?phpinclude_once('commun/MyPage.php');include_once('commun/MyBdd.php');include_once('commun/MyTools.php');define('FPDF_FONTPATH','font/');require('fpdf/fpdf.php');// Gestion de la Feuille de Classementclass FeuilleCltNiveau extends MyPage	 {		function FeuilleCltNiveau()	{		MyPage::MyPage();	  		$myBdd = new MyBdd();				$codeCompet = utyGetSession('codeCompet', '');		$codeSaison = utyGetSaison();		$codeSaison = utyGetGet('S', $codeSaison);		$arrayCompetition = $myBdd->GetCompetition($codeCompet, $codeSaison);		$titreCompet = 'Compétition : '.$arrayCompetition['Libelle'].' ('.$codeCompet.')';		$qualif = $arrayCompetition['Qualifies'];		$elim = $arrayCompetition['Elimines'];				$logo = "img/logo/".$codeSaison.'-'.$codeCompet.'.jpg';		//Saison			$titreDate = "Saison ".$codeSaison;		//Création		$pdf = new FPDF('L');		$pdf->Open();		$pdf->SetTitle("Classement");				$pdf->SetAuthor("Poloweb.org");		$pdf->SetCreator("Poloweb.org avec FPDF");		$pdf->AddPage();		$pdf->SetAutoPageBreak(true, 15);				// logo		$pdf->Image($_SERVER['DOCUMENT_ROOT'].'/css/banniere1.jpg',10,8,72,15,'jpg',"http://www.kayak-polo.info");		$pdf->Image($_SERVER['DOCUMENT_ROOT'].'/css/logo_ffck4.png',255,8,24,15,'png',"http://www.ffck.org");		if(file_exists($logo))		{			list($width, $height, $type, $attr) = getimagesize($logo);			$x = 146 - ($width / $height * 20 / 2);			$pdf->Image($logo,$x,8,0,20,'jpg');			$pdf->Ln(5);		}		$pdf->Ln(14);		// titre		$pdf->SetFont('Arial','BI',10);		$pdf->Cell(137,5,"Compétition à élimination",'LT','0','L');		$pdf->Cell(136,5,$titreDate,'TR','1','R');		$pdf->SetFont('Arial','B',14);		$pdf->Cell(273,5,$titreCompet,'LR','1','C');		$pdf->Cell(273,5,"Classement général",'LRB','1','C');		$pdf->SetFont('Arial','BI',9);		$pdf->Cell(137,5,"Edité le ".date("d/m/Y")." à ".date("H:i"),'0','0','L');		$pdf->Cell(136,5,"Classement officiel",'0','1','R');				$pdf->Ln(4);		//données				$sql  = "Select Id, Libelle, Code_club, Clt_publi, Pts_publi, J_publi, G_publi, N_publi, P_publi, F_publi, Plus_publi, Moins_publi, Diff_publi, PtsNiveau_publi, CltNiveau_publi ";		$sql .= "From gickp_Competitions_Equipes ";		$sql .= "Where Code_compet = '";		$sql .= $codeCompet;		$sql .= "' And Code_saison = '";		$sql .= $codeSaison;		$sql .= "' Order By CltNiveau_publi Asc, Diff_publi Desc ";	 			$result = mysql_query($sql, $myBdd->m_link) or die ("Erreur Load");		$num_results = mysql_num_rows($result);				// recalcul des éliminés		$elim = $num_results - $elim;		$pdf->Cell(72,6, '','','0','L');		$pdf->Cell(30, 6, 'Classement', 'LTR','0','C');		$pdf->Cell(100,6, 'Equipe','RT','1','C');		$pdf->Cell(72,3, '','','0');		$pdf->Cell(130, 3, '', 'TB','1','C');				for ($i=0;$i<$num_results;$i++)		{			$row = mysql_fetch_array($result);				$separation = 0;			//Séparation qualifiés			if (($i+1) > $qualif && $qualif != 0)			{				$pdf->Cell(72,1, '', 0,0);				$pdf->Cell(130,1, '', 0,1);				$qualif =0;				$separation = 1;			}			//Séparation éliminés			if (($i+1) > $elim && $elim != 0)			{				if ($separation != 1)				{					$pdf->Cell(72,1, '', 0,0);					$pdf->Cell(130,1, '', 0,1);				}				$elim =0;			}						$pdf->SetFont('Arial','B',12);			$pdf->Cell(72,6, '','','0','L');			$pdf->Cell(30, 5, $row['CltNiveau_publi'], 'LTBR','0','C');			$pdf->Cell(100,5, $row['Libelle'],'RTB','1','L');		}					$pdf->Output('Classement '.$codeCompet,'I');	}}$page = new FeuilleCltNiveau();?>